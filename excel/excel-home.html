<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Programmer's Picnic â€“ Excel Course Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-body: #fff7e6;
      --bg-panel: #fffaf0;
      --bg-card: #fffaf0;
      --text-main: #3a2a1a;
      --accent-strong: #b35a00;
      --accent-med: #a14c00;
      --accent-soft: #8c3f00;
      --border-soft: #f3c26b;
      --pill-bg: #ffefd3;
      --pill-border: #f3c26b;
      --pill-active-bg: #ffcc73;
      --pill-active-border: #b57400;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
      background: var(--bg-body);
      color: var(--text-main);
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px;
    }

    .top-bar {
      text-align: center;
      margin-bottom: 10px;
    }

    .top-bar h1 {
      color: var(--accent-strong);
      font-size: 2rem;
      margin: 10px 0 4px 0;
    }

    .top-subtitle {
      font-size: 0.95rem;
      color: var(--accent-soft);
      opacity: 0.9;
    }

    .layout {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      margin-top: 14px;
    }

    .sidebar {
      width: 260px;
      background: var(--bg-panel);
      border: 1px solid var(--border-soft);
      border-radius: 14px;
      padding: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.06);
      position: sticky;
      top: 8px;
      max-height: calc(100vh - 20px);
      overflow-y: auto;
    }

    .sidebar h2 {
      font-size: 1rem;
      margin-top: 0;
      color: var(--accent-med);
    }

    .search-box {
      margin-bottom: 10px;
    }

    .search-box input {
      width: 100%;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid var(--border-soft);
      font-size: 0.9rem;
      background: #fff;
    }

    .sidebar-section-title {
      font-size: 0.85rem;
      font-weight: 700;
      margin-top: 8px;
      color: var(--accent-soft);
    }

    .pill-group {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 6px 0 10px 0;
    }

    .pill {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg);
      font-size: 0.8rem;
      cursor: pointer;
      white-space: nowrap;
    }

    .pill.active {
      background: var(--pill-active-bg);
      border-color: var(--pill-active-border);
      font-weight: 600;
    }

    .start-btn {
      width: 100%;
      margin-top: 8px;
      padding: 8px 12px;
      border-radius: 10px;
      border: 1px solid #b57400;
      background: #ffcc73;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
    }

    .start-btn:hover {
      background: #ffdb9b;
    }

    .recent-list {
      list-style: none;
      padding-left: 0;
      margin: 6px 0 0 0;
      font-size: 0.85rem;
    }

    .recent-list li {
      margin-bottom: 4px;
    }

    .recent-link {
      color: var(--accent-soft);
      text-decoration: none;
      font-size: 0.85rem;
    }

    .recent-link:hover {
      text-decoration: underline;
    }

    .main {
      flex: 1;
      background: var(--bg-panel);
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      padding: 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.06);
    }

    .main-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .main-header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--accent-med);
    }

    .main-header-meta {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-soft);
      padding: 14px;
      border-radius: 14px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
      gap: 8px;
      transition: 0.18s ease;
      position: relative;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 12px rgba(0, 0, 0, 0.12);
    }

    .card-title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--accent-med);
      margin-bottom: 2px;
    }

    .card-tags {
      font-size: 0.78rem;
      color: var(--accent-soft);
    }

    .card-desc {
      font-size: 0.85rem;
      color: var(--text-main);
    }

    .badge-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.78rem;
      margin-top: 4px;
    }

    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--pill-border);
      background: var(--pill-bg);
    }

    .badge.easy {
      border-color: #22c55e;
      background: #dcfce7;
      color: #166534;
    }

    .badge.medium {
      border-color: #eab308;
      background: #fef9c3;
      color: #854d0e;
    }

    .badge.hard {
      border-color: #ef4444;
      background: #fee2e2;
      color: #b91c1c;
    }

    .button-row {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      gap: 6px;
    }

    .button {
      flex: 1;
      background: #ffcc73;
      border: 1px solid #b57400;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 0.85rem;
      color: #3a2a1a;
      text-decoration: none;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
    }

    .button.secondary {
      background: #fff;
      border-color: var(--border-soft);
      font-weight: 500;
    }

    .button:hover {
      background: #ffdb9b;
    }

    .button.secondary:hover {
      background: #fff7e6;
    }

    .footer {
      margin-top: 16px;
      text-align: center;
      font-size: 0.8rem;
      opacity: 0.7;
    }

    @media (max-width: 860px) {
      .layout {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        position: static;
        max-height: none;
      }
    }
  </style>
</head>

<body>
  <div class="page">
    <div class="top-bar">
      <h1>Programmer's Picnic â€“ Excel Course</h1>
      <div class="top-subtitle">
        15-lesson Excel job track Â· JSON-driven Â· Classroom downloads
      </div>
    </div>

    <div class="layout">
      <aside class="sidebar">
        <h2>Find a Lesson</h2>
        <div class="search-box">
          <input id="searchInput" type="text" placeholder="Search by topic (e.g. pivot, lookup, cleaning)..." />
        </div>

        <div class="sidebar-section-title">Difficulty</div>
        <div id="difficultyPills" class="pill-group">
          <div class="pill active" data-diff="all">All</div>
          <div class="pill" data-diff="easy">Easy</div>
          <div class="pill" data-diff="medium">Medium</div>
          <div class="pill" data-diff="hard">Hard</div>
        </div>

        <div class="sidebar-section-title">Category</div>
        <div id="categoryPills" class="pill-group">
          <div class="pill active" data-cat="all">All</div>
          <div class="pill" data-cat="basics">Basics</div>
          <div class="pill" data-cat="functions">Functions</div>
          <div class="pill" data-cat="data">Data Tools</div>
          <div class="pill" data-cat="analysis">Analysis & Dashboards</div>
          <div class="pill" data-cat="power">Power Query / Advanced</div>
        </div>

        <button class="start-btn" id="startCourseBtn">ðŸš€ Start Excel Course</button>

        <div class="sidebar-section-title">Job Track</div>
        <button class="start-btn" id="jobTrackBtn">ðŸ’¼ Open Job Track 101</button>

        <div class="sidebar-section-title">Recently Viewed</div>
        <ul id="recentList" class="recent-list"></ul>

        <div class="sidebar-section-title">Progress</div>
        <div id="progressText" style="font-size:0.8rem;"></div>
      </aside>

      <main class="main">
        <div class="main-header">
          <div class="main-header-title">All Excel Lessons</div>
          <div class="main-header-meta" id="metaText"></div>
        </div>

        <div id="lessonGrid" class="grid"></div>

        <div class="footer">
          Â© Programmer's Picnic â€¢ Excel Job Track â€¢ Built with love in Varanasi ðŸ’›
        </div>
      </main>
    </div>
  </div>

  <script>
    const JSON_BASE = "./json/";
    const VIEWER_PAGE = "excel-viewer.html";

    const LESSONS = [
      { id: 1, title: "Introduction to Excel", difficulty: "easy", category: "basics" },
      { id: 2, title: "Basic Formulas & Operators", difficulty: "easy", category: "basics" },
      { id: 3, title: "Essential Functions", difficulty: "easy", category: "functions" },
      { id: 4, title: "Text Functions", difficulty: "easy", category: "functions" },
      { id: 5, title: "Logical Functions", difficulty: "medium", category: "functions" },
      { id: 6, title: "Lookup Functions â€“ VLOOKUP & HLOOKUP", difficulty: "medium", category: "functions" },
      { id: 7, title: "XLOOKUP â€“ Modern Lookup", difficulty: "medium", category: "functions" },
      { id: 8, title: "Conditional Formatting", difficulty: "medium", category: "data" },
      { id: 9, title: "Data Cleaning Tools", difficulty: "medium", category: "data" },
      { id: 10, title: "Data Validation & Dropdowns", difficulty: "medium", category: "data" },
      { id: 11, title: "Sorting & Filtering", difficulty: "medium", category: "data" },
      { id: 12, title: "Pivot Tables", difficulty: "medium", category: "analysis" },
      { id: 13, title: "Charts & Dashboards", difficulty: "medium", category: "analysis" },
      { id: 14, title: "Power Query Basics", difficulty: "hard", category: "power" },
      { id: 15, title: "Excel for Programmers (Bonus)", difficulty: "medium", category: "analysis" }
    ];

    const COMPLETED_KEY = "pp_excel_completed_lessons";
    const RECENT_KEY = "pp_excel_recent_lessons";

    function loadCompleted() {
      try { const raw = localStorage.getItem(COMPLETED_KEY); return raw ? JSON.parse(raw) : []; }
      catch { return []; }
    }
    function saveCompleted(ids) { localStorage.setItem(COMPLETED_KEY, JSON.stringify(ids)); }
    function loadRecent() {
      try { const raw = localStorage.getItem(RECENT_KEY); return raw ? JSON.parse(raw) : []; }
      catch { return []; }
    }
    function saveRecent(ids) { localStorage.setItem(RECENT_KEY, JSON.stringify(ids)); }

    let searchQuery = "";
    let difficultyFilter = "all";
    let categoryFilter = "all";
    let completedLessons = loadCompleted();
    let recentLessons = loadRecent();

    const gridEl = document.getElementById("lessonGrid");
    const metaTextEl = document.getElementById("metaText");
    const progressTextEl = document.getElementById("progressText");
    const recentListEl = document.getElementById("recentList");

    function difficultyLabel(diff) {
      if (diff === "easy") return "Easy";
      if (diff === "medium") return "Medium";
      if (diff === "hard") return "Hard";
      return diff;
    }
    function categoryLabel(cat) {
      const m = { basics: "Basics", functions: "Functions", data: "Data Tools", analysis: "Analysis & Dashboards", power: "Power Query / Advanced" };
      return m[cat] || cat;
    }
    function description(lesson) {
      return categoryLabel(lesson.category) + " Â· " + difficultyLabel(lesson.difficulty);
    }
    function passesFilters(lesson) {
      const text = (lesson.title + " " + description(lesson)).toLowerCase();
      if (searchQuery && !text.includes(searchQuery.toLowerCase())) return false;
      if (difficultyFilter !== "all" && lesson.difficulty !== difficultyFilter) return false;
      if (categoryFilter !== "all" && lesson.category !== categoryFilter) return false;
      return true;
    }

    function renderLessons() {
      const visible = LESSONS.filter(passesFilters);
      gridEl.innerHTML = "";
      visible.forEach(lesson => {
        const jsonURL = JSON_BASE + "excel-lesson-" + lesson.id + ".json";
        const viewerURL = VIEWER_PAGE + "?json=" + encodeURIComponent(jsonURL);
        const isDone = completedLessons.includes(lesson.id);
        const diffText = difficultyLabel(lesson.difficulty);
        const catText = categoryLabel(lesson.category);
        gridEl.innerHTML += `
          <div class="card">
            <div class="card-title">Lesson ${lesson.id}: ${lesson.title}</div>
            <div class="card-tags">${catText} Â· ${diffText}</div>
            <div class="card-desc">Job-style Excel training focused on ${lesson.title.toLowerCase()}.</div>
            <div class="badge-row">
              <span class="badge ${lesson.difficulty}">${diffText}</span>
              ${isDone ? '<span class="badge" style="border-color:#16a34a;background:#dcfce7;color:#166534;font-weight:600;">Completed âœ”</span>' : ""}
            </div>
            <div class="button-row">
              <a class="button" href="${viewerURL}" onclick="handleOpenLesson(${lesson.id});" target="_blank">Open Lesson â†’</a>
              <button class="button secondary" onclick="toggleDone(${lesson.id})">
                ${isDone ? "Mark Not Done" : "Mark Done"}
              </button>
            </div>
          </div>
        `;
      });
      metaTextEl.textContent = `Showing ${visible.length} of ${LESSONS.length} lessons`;
      renderProgress();
    }

    function renderProgress() {
      const total = LESSONS.length;
      const done = completedLessons.length;
      const pct = total ? Math.round(done / total * 100) : 0;
      progressTextEl.textContent = `${done} / ${total} lessons marked complete (${pct}%)`;
    }

    function renderRecent() {
      recentListEl.innerHTML = "";
      if (!recentLessons.length) {
        recentListEl.innerHTML = "<li><em>No lessons viewed yet.</em></li>";
        return;
      }
      recentLessons.slice(0, 5).forEach(id => {
        const lesson = LESSONS.find(l => l.id === id);
        if (!lesson) return;
        const jsonURL = JSON_BASE + "excel-lesson-" + lesson.id + ".json";
        const viewerURL = VIEWER_PAGE + "?json=" + encodeURIComponent(jsonURL);
        const li = document.createElement("li");
        li.innerHTML = `<a class="recent-link" href="${viewerURL}" target="_blank">Lesson ${lesson.id}: ${lesson.title}</a>`;
        recentListEl.appendChild(li);
      });
    }

    function handleOpenLesson(id) {
      recentLessons = [id, ...recentLessons.filter(x => x !== id)].slice(0, 10);
      saveRecent(recentLessons);
      renderRecent();
    }

    function toggleDone(id) {
      if (completedLessons.includes(id)) {
        completedLessons = completedLessons.filter(x => x !== id);
      } else {
        completedLessons.push(id);
      }
      saveCompleted(completedLessons);
      renderLessons();
      renderRecent();
    }

    window.handleOpenLesson = handleOpenLesson;
    window.toggleDone = toggleDone;

    document.getElementById("searchInput").addEventListener("input", e => {
      searchQuery = e.target.value.trim();
      renderLessons();
    });

    Array.from(document.getElementById("difficultyPills").children).forEach(pill => {
      pill.addEventListener("click", () => {
        Array.from(document.getElementById("difficultyPills").children).forEach(p => p.classList.remove("active"));
        pill.classList.add("active");
        difficultyFilter = pill.dataset.diff;
        renderLessons();
      });
    });

    Array.from(document.getElementById("categoryPills").children).forEach(pill => {
      pill.addEventListener("click", () => {
        Array.from(document.getElementById("categoryPills").children).forEach(p => p.classList.remove("active"));
        pill.classList.add("active");
        categoryFilter = pill.dataset.cat;
        renderLessons();
      });
    });

    document.getElementById("startCourseBtn").addEventListener("click", () => {
      const firstNotDone = LESSONS.find(l => !completedLessons.includes(l.id)) || LESSONS[0];
      const jsonURL = JSON_BASE + "excel-lesson-" + firstNotDone.id + ".json";
      const viewerURL = VIEWER_PAGE + "?json=" + encodeURIComponent(jsonURL);
      handleOpenLesson(firstNotDone.id);
      window.open(viewerURL, "_blank");
    });

    document.getElementById("jobTrackBtn").addEventListener("click", () => {
      const jsonURL = JSON_BASE + "excel-job-track-101.json";
      const viewerURL = VIEWER_PAGE + "?json=" + encodeURIComponent(jsonURL);
      window.open(viewerURL, "_blank");
    });

    renderLessons();
    renderRecent();
  </script>
</body>

</html>