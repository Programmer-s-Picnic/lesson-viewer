<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Programmer's Picnic – Excel Concept Visualizers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
      background: #fff7e6;
      color: #3a2a1a;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
      background: #fffaf0;
      border-radius: 16px;
      border: 1px solid #f3c26b;
      box-shadow: 0 4px 14px rgba(0,0,0,0.06);
      margin-top: 10px;
      margin-bottom: 20px;
    }
    h1, h2 {
      color: #b35a00;
    }
    .mode-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }
    .btn-mode {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid #b57400;
      background: #ffcc73;
      font-size: 0.85rem;
      cursor: pointer;
      font-weight: 600;
    }
    .btn-mode.active {
      background: #ffdb9b;
    }
    .panel {
      margin-top: 10px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #f3c26b;
      background: #fff3d1;
    }
    .mini-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 6px;
      margin-top: 8px;
    }
    .cell {
      border-radius: 8px;
      border: 1px solid #f3c26b;
      background: #fff8e1;
      padding: 6px;
      text-align: center;
      font-size: 0.85rem;
      position: relative;
    }
    .cell-label {
      font-size: 0.7rem;
      opacity: 0.8;
      position: absolute;
      top: 3px;
      left: 4px;
    }
    .cell.highlight {
      background: #dcfce7;
      border-color: #16a34a;
    }
    .log {
      margin-top: 8px;
      padding: 8px;
      border-radius: 8px;
      border: 1px dashed #f3c26b;
      background: #fff8dd;
      font-size: 0.9rem;
      min-height: 48px;
    }
    input[type="text"] {
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px solid #f3c26b;
      font-size: 0.85rem;
      background: #fff;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Excel Concept Visualizers</h1>
    <p>Select a mode to see a simple, visual explanation. These sit beside your real Excel practice.</p>

    <div class="mode-buttons">
      <button class="btn-mode active" data-mode="formula">Formula Flow</button>
      <button class="btn-mode" data-mode="lookup">Lookup (XLOOKUP / VLOOKUP)</button>
      <button class="btn-mode" data-mode="sumif">SUMIF / COUNTIF</button>
    </div>

    <div id="panel"></div>
  </div>

  <script>
    const panel = document.getElementById("panel");
    const buttons = document.querySelectorAll(".btn-mode");

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        renderMode(btn.dataset.mode);
      });
    });

    function renderMode(mode) {
      if (mode === "lookup") renderLookup();
      else if (mode === "sumif") renderSumif();
      else renderFormula();
    }

    function renderFormula() {
      panel.innerHTML = `
        <div class="panel">
          <h2>Formula Flow Visualizer</h2>
          <p>Type a simple formula like <code>=A2+B2</code> and see which cells are involved.</p>
          <div class="row">
            <label>Formula:</label>
            <input id="formulaInput" type="text" value="=A2+B2" />
            <button onclick="runFormulaFlow()">Highlight</button>
          </div>
          <div class="mini-grid" style="margin-top:10px;">
            <div class="cell" data-cell="A2"><span class="cell-label">A2</span>10</div>
            <div class="cell" data-cell="B2"><span class="cell-label">B2</span>5</div>
            <div class="cell" data-cell="C2"><span class="cell-label">C2</span>=A2+B2</div>
          </div>
          <div id="formulaLog" class="log">Waiting for formula…</div>
        </div>
      `;
      window.runFormulaFlow = () => {
        const input = document.getElementById("formulaInput").value.trim().toUpperCase();
        const log = document.getElementById("formulaLog");
        document.querySelectorAll(".cell").forEach(c => c.classList.remove("highlight"));
        const refs = Array.from(input.matchAll(/[A-Z]+[0-9]+/g)).map(m => m[0]);
        if (!refs.length) {
          log.textContent = "No cell references detected. Try something like =A2+B2.";
          return;
        }
        refs.forEach(r => {
          const cell = document.querySelector(`.cell[data-cell="${r}"]`);
          if (cell) cell.classList.add("highlight");
        });
        log.textContent = "Formula references: " + refs.join(", ") + ". These cells must be correct for the result cell to be correct.";
      };
    }

    function renderLookup() {
      panel.innerHTML = `
        <div class="panel">
          <h2>Lookup Visualizer (XLOOKUP / VLOOKUP)</h2>
          <p>Search for a product code. The matching row will highlight.</p>
          <div class="row">
            <label>Lookup Code:</label>
            <input id="lookupInput" type="text" value="P102" />
            <button onclick="runLookup()">Lookup</button>
          </div>
          <div class="mini-grid" style="margin-top:10px;">
            <div class="cell" data-row="1"><span class="cell-label">Code</span>P101<br/>Pen</div>
            <div class="cell" data-row="2"><span class="cell-label">Code</span>P102<br/>Notebook</div>
            <div class="cell" data-row="3"><span class="cell-label">Code</span>P103<br/>Marker</div>
          </div>
          <div id="lookupLog" class="log">Try P101, P102 or P103.</div>
        </div>
      `;
      window.runLookup = () => {
        const value = document.getElementById("lookupInput").value.trim().toUpperCase();
        const log = document.getElementById("lookupLog");
        document.querySelectorAll(".cell").forEach(c => c.classList.remove("highlight"));
        const map = { "P101": 1, "P102": 2, "P103": 3 };
        const row = map[value];
        if (!row) {
          log.textContent = "Not found. In Excel, XLOOKUP would return #N/A or your chosen 'not found' message.";
          return;
        }
        const cell = document.querySelector(`.cell[data-row="${row}"]`);
        if (cell) cell.classList.add("highlight");
        log.textContent = `Match found on row ${row}. XLOOKUP/VLOOKUP would return the cells from that row.`;
      };
    }

    function renderSumif() {
      panel.innerHTML = `
        <div class="panel">
          <h2>SUMIF / COUNTIF Visualizer</h2>
          <p>Choose a region and see which records would be included in a SUMIF/COUNTIF.</p>
          <div class="row">
            <label>Region:</label>
            <input id="regionInput" type="text" value="North" />
            <button onclick="runRegion()">Highlight</button>
          </div>
          <div class="mini-grid" style="margin-top:10px;">
            <div class="cell" data-region="NORTH"><span class="cell-label">Row 1</span>North – 1000</div>
            <div class="cell" data-region="SOUTH"><span class="cell-label">Row 2</span>South – 800</div>
            <div class="cell" data-region="NORTH"><span class="cell-label">Row 3</span>North – 1200</div>
          </div>
          <div id="regionLog" class="log">Try 'North' or 'South'.</div>
        </div>
      `;
      window.runRegion = () => {
        const value = document.getElementById("regionInput").value.trim().toUpperCase();
        const log = document.getElementById("regionLog");
        document.querySelectorAll(".cell").forEach(c => c.classList.remove("highlight"));
        const cells = Array.from(document.querySelectorAll(`.cell[data-region="${value}"]`));
        if (!cells.length) {
          log.textContent = "No rows match this region. SUMIF/COUNTIF would return zero.";
          return;
        }
        cells.forEach(c => c.classList.add("highlight"));
        log.textContent = `These rows match the region '${value}'. SUMIF would add their amounts, COUNTIF would count them.`;
      };
    }

    renderMode("formula");
  </script>
</body>
</html>
