<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pyodide Editor ‚Äî Fix loadPyodide not found</title>
  <style>
    :root{--bg:#fff7e6;--card:#fff;--ink:#1f2937;--muted:#6b7280;--brand:#d97706;--brand2:#f59e0b;--border:#eadcc5;--shadow:0 18px 40px rgba(31,41,55,.08);--good:#059669;--bad:#dc2626;--warn:#b45309}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",Arial;background:var(--bg);color:var(--ink)}
    .wrap{max-width:980px;margin:18px auto;padding:0 14px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px}
    h1{margin:0 0 10px;font-size:24px}
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .pill{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--border);border-radius:999px;padding:7px 10px;background:#fff;font-size:13px;color:var(--muted)}
    .dot{width:10px;height:10px;border-radius:999px;background:#cbd5e1;box-shadow:0 0 0 4px rgba(203,213,225,.35)}
    .dot.good{background:var(--good);box-shadow:0 0 0 4px rgba(5,150,105,.18)}
    .dot.bad{background:var(--bad);box-shadow:0 0 0 4px rgba(220,38,38,.16)}
    .dot.warn{background:var(--warn);box-shadow:0 0 0 4px rgba(180,83,9,.16)}
    .btn{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#fff;font-weight:700;cursor:pointer}
    .btn.primary{border:none;color:#fff;background:linear-gradient(135deg,var(--brand),var(--brand2))}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    textarea{width:100%;min-height:240px;margin-top:12px;border:1px solid var(--border);border-radius:14px;padding:12px;background:#0b1220;color:#e5e7eb;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:14px;line-height:1.5}
    pre{margin-top:12px;background:#0b1220;color:#e5e7eb;border-radius:14px;border:1px solid rgba(255,255,255,.12);padding:12px;min-height:140px;white-space:pre-wrap;word-break:break-word;overflow:auto}
    .callout{margin-top:10px;border-left:4px solid var(--brand2);background:rgba(245,158,11,.12);border-radius:12px;padding:10px 12px;color:var(--ink)}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Pyodide Editor ‚Äî Robust Loader</h1><div class="row">
    <span class="pill"><span id="dot" class="dot"></span> <span id="status">Click ‚ÄúLoad Pyodide‚Äù</span></span>
    <span class="pill">Protocol: <b id="proto"></b></span>
    <span class="pill">CDN: <b id="cdn">‚Äî</b></span>
  </div>

  <div class="callout" id="fileTip" style="display:none;">
    <b>‚ö†Ô∏è You opened this as <code>file:///</code>.</b>
    Many browsers block loading Pyodide from CDNs in local-file mode.
    <br><b>Fix:</b> open using VS Code Live Server (http://localhost) or host on GitHub Pages.
  </div>

  <div class="row" style="margin-top:12px;">
    <button class="btn" id="loadBtn">üîÑ Load Pyodide</button>
    <button class="btn primary" id="runBtn" disabled>‚ñ∂ Run</button>
    <button class="btn" id="testBtn" disabled>üß™ Test</button>
    <button class="btn" id="clearBtn">üßπ Clear output</button>
  </div>

  <textarea id="editor" spellcheck="false">print("Hello from Pyodide!")

import sys print("Python:", sys.version.split()[0]) print("2 + 3 =", 2 + 3)</textarea>

<pre id="out">Output will appear here‚Ä¶</pre>
</div>

  </div>  <script>
    const SOURCES = [
      { name:"jsDelivr", js:"https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js", indexURL:"https://cdn.jsdelivr.net/pyodide/v0.26.2/full/" },
      { name:"unpkg",   js:"https://unpkg.com/pyodide@0.26.2/pyodide.js",                indexURL:"https://unpkg.com/pyodide@0.26.2/" }
    ];

    const $ = (id) => document.getElementById(id);
    const dot = $("dot"), status = $("status"), proto = $("proto"), cdn = $("cdn");
    const out = $("out"), editor = $("editor");
    const loadBtn = $("loadBtn"), runBtn = $("runBtn"), testBtn = $("testBtn"), clearBtn = $("clearBtn");
    const fileTip = $("fileTip");

    proto.textContent = location.protocol;
    if (location.protocol === "file:") fileTip.style.display = "block";

    let pyodide = null;

    function setState(kind, text){
      dot.className = "dot" + (kind ? " " + kind : "");
      status.textContent = text;
    }
    function setOut(t){ out.textContent = t; }
    function appendOut(t){ out.textContent += String(t ?? ""); }

    function injectScript(src){
      return new Promise((resolve, reject) => {
        const s = document.createElement("script");
        s.src = src;
        s.async = true;
        s.onload = () => resolve(true);
        s.onerror = () => reject(new Error("Script failed to load: " + src));
        document.head.appendChild(s);
      });
    }

    async function loadPyodideRobust(){
      setOut("");
      setState("warn","Loading pyodide.js‚Ä¶");
      loadBtn.disabled = true; runBtn.disabled = true; testBtn.disabled = true;

      let lastErr = null;

      for (const src of SOURCES){
        try{
          cdn.textContent = src.name;

          if (!window.loadPyodide){
            setState("warn","Downloading pyodide.js from " + src.name + "‚Ä¶");
            await injectScript(src.js);
          }

          if (!window.loadPyodide){
            throw new Error("loadPyodide is still not available after loading " + src.name);
          }

          setState("warn","Initializing Pyodide (" + src.name + ")‚Ä¶");
          pyodide = await window.loadPyodide({ indexURL: src.indexURL });

          pyodide.setStdout({ batched: (s) => appendOut(s) });
          pyodide.setStderr({ batched: (s) => appendOut(s) });

          setState("good","Ready ‚úÖ");
          runBtn.disabled = false; testBtn.disabled = false; loadBtn.disabled = false;
          if(out.textContent.trim()==="") setOut("Pyodide loaded successfully. Click Run.");
          return;

        }catch(err){
          lastErr = err;
          setOut((out.textContent || "") + "Tried " + src.name + " ‚Üí failed.\n" + String(err) + "\n\n");
        }
      }

      setState("bad","Failed ‚ùå");
      cdn.textContent = "blocked/unavailable";
      loadBtn.disabled = false;

      setOut((out.textContent || "") +
        "\nMost likely causes:\n" +
        "1) Opened as file:/// (use http:// via Live Server)\n" +
        "2) CDN blocked (Private DNS / adblock / network)\n" +
        "3) Browser too old\n\n" +
        "Final error:\n" + String(lastErr)
      );
    }

    async function runCode(code){
      if(!pyodide){ setOut("Pyodide not loaded. Click Load Pyodide."); return; }
      setState("warn","Running‚Ä¶");
      setOut("");
      try{
        await pyodide.runPythonAsync(code);
        setState("good","Done ‚úÖ");
        if(out.textContent.trim()==="") setOut("(No output) Ran successfully.");
      }catch(err){
        setState("bad","Error ‚ùå");
        setOut(String(err));
      }
    }

    loadBtn.addEventListener("click", loadPyodideRobust);
    runBtn.addEventListener("click", () => runCode(editor.value));
    testBtn.addEventListener("click", () => runCode('print("Pyodide test OK ‚úÖ")\nprint(10*10)'));
    clearBtn.addEventListener("click", () => setOut("Output cleared."));
  </script></body>
</html>