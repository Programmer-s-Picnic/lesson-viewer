<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Python range() ‚Äî Comprehensive + Pyodide (Fixed Output)</title>
    <meta
      name="description"
      content="A comprehensive lesson on Python range() with examples and a Pyodide editor. Output handling fixed so print() and \\n always create real line breaks."
    />

    <style>
      :root {
        /* Light saffron theme */
        --bg: #fff7e6;
        --card: #ffffff;
        --ink: #1f2937;
        --muted: #6b7280;
        --brand: #d97706;
        --brand2: #f59e0b;
        --border: #eadcc5;
        --shadow: 0 16px 34px rgba(0, 0, 0, 0.08);

        --codebg: #eefbf1;
        --chip: #fff1d6;
        --chipInk: #7c2d12;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Segoe UI", system-ui, -apple-system, Roboto, Arial,
          sans-serif;
        background: var(--bg);
        color: var(--ink);
        padding: 24px;
        line-height: 1.65;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
      }

      header.hero {
        background: linear-gradient(180deg, #ffffff, #fff3d1);
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 18px 18px 14px;
        box-shadow: var(--shadow);
        margin-bottom: 18px;
      }

      h1 {
        margin: 0 0 6px;
        color: #7c2d12;
        font-size: 1.85rem;
        line-height: 1.2;
      }

      h2 {
        margin-top: 22px;
        margin-bottom: 10px;
        color: #92400e;
        font-size: 1.32rem;
      }

      h3 {
        margin: 14px 0 8px;
        color: #7c2d12;
        font-size: 1.08rem;
      }

      p,
      li {
        color: var(--ink);
      }

      .muted {
        color: var(--muted);
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
      }
      @media (min-width: 980px) {
        .grid.two {
          grid-template-columns: 1.1fr 0.9fr;
        }
      }

      ul,
      ol {
        padding-left: 22px;
      }

      .chip {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 4px 10px;
        border-radius: 999px;
        background: var(--chip);
        border: 1px solid var(--border);
        color: var(--chipInk);
        font-weight: 700;
        font-size: 0.88rem;
      }

      code {
        background: var(--codebg);
        padding: 2px 6px;
        border-radius: 6px;
        border: 1px solid #d6f2dc;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        font-size: 0.98em;
      }

      /* Code block wrapper */
      .codeblock {
        border: 1px solid var(--border);
        background: var(--card);
        border-radius: 14px;
        overflow: hidden;
        box-shadow: var(--shadow);
        margin: 12px 0 14px;
      }
      .codeblock .bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 12px;
        border-bottom: 1px solid var(--border);
        background: #fff1d6;
        gap: 10px;
      }
      .codeblock .bar .label {
        font-weight: 700;
        color: #7c2d12;
        font-size: 0.95rem;
      }

      button {
        appearance: none;
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: linear-gradient(180deg, var(--brand2), var(--brand));
        color: #fff;
        padding: 8px 12px;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 700;
        transition: transform 0.05s ease, filter 0.15s ease;
        white-space: nowrap;
      }
      button:hover {
        filter: brightness(1.03);
      }
      button:active {
        transform: translateY(1px);
      }
      button:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }

      .btn-ghost {
        background: #fff;
        color: #7c2d12;
        border: 1px solid var(--border);
      }

      pre {
        margin: 0;
        padding: 12px;
        background: var(--codebg);
        overflow: auto;
      }
      pre code {
        border: none;
        background: transparent;
        padding: 0;
        display: block;
        white-space: pre;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: var(--shadow);
        padding: 14px;
      }

      .callout {
        background: #fffbe7;
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 16px;
        box-shadow: var(--shadow);
        margin: 14px 0;
      }

      .warn {
        background: #fff1f2;
        border: 1px solid #fecdd3;
      }

      .kpi {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      @media (min-width: 780px) {
        .kpi {
          grid-template-columns: repeat(4, 1fr);
        }
      }
      .kpi .box {
        background: #fff;
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 10px;
      }
      .kpi .box .t {
        font-weight: 800;
        color: #7c2d12;
      }
      .kpi .box .s {
        color: var(--muted);
        font-size: 0.92rem;
      }

      /* Pyodide editor */
      .editor {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
      }
      @media (min-width: 980px) {
        .editor {
          grid-template-columns: 1fr 1fr;
        }
      }

      textarea {
        width: 100%;
        min-height: 290px;
        resize: vertical;
        border-radius: 14px;
        border: 1px solid var(--border);
        padding: 12px;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        font-size: 14px;
        background: #fff;
        color: var(--ink);
        outline: none;
      }

      .output {
        border-radius: 14px;
        border: 1px solid var(--border);
        padding: 12px;
        background: #0b1220;
        color: #e5e7eb;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        min-height: 290px;
        white-space: pre-wrap; /* preserve \n line breaks */
        overflow: auto;
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
      }

      .status {
        font-weight: 700;
        color: var(--muted);
      }

      details summary {
        cursor: pointer;
        font-weight: 800;
        color: #7c2d12;
        margin: 8px 0;
      }

      footer {
        margin-top: 22px;
        color: var(--muted);
        font-size: 0.95rem;
        text-align: center;
      }

      .kbd {
        display: inline-block;
        padding: 2px 7px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: #fff;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        font-weight: 700;
        font-size: 0.92em;
        color: #7c2d12;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <header class="hero">
        <h1>
          üîÅ Python <code>range()</code> ‚Äî Comprehensive Guide + Practice Editor
        </h1>
        <p class="muted">
          Learn how <code>range()</code> works (start/stop/step, negatives,
          slicing, indexing, membership tests) and run code instantly using
          Pyodide.
        </p>
        <p class="muted" style="margin: 6px 0 0">
          Shortcut: <span class="kbd">Ctrl</span> + <span class="kbd">Enter</span>
          to Run.
        </p>
      </header>

      <div class="kpi">
        <div class="box">
          <div class="t">What it is</div>
          <div class="s">An iterable of ints (lazy)</div>
        </div>
        <div class="box">
          <div class="t">Common use</div>
          <div class="s">Loop counts / indices</div>
        </div>
        <div class="box">
          <div class="t">Memory</div>
          <div class="s">Doesn‚Äôt store all numbers</div>
        </div>
        <div class="box">
          <div class="t">Stop rule</div>
          <div class="s">Stop is <em>excluded</em></div>
        </div>
      </div>

      <h2>1) What is <code>range()</code>?</h2>
      <div class="card">
        <p>
          <code>range()</code> creates a <strong>range object</strong>. It‚Äôs an
          iterable ‚Äúrecipe‚Äù for numbers (not a stored list).
        </p>
        <ul>
          <li>Iterable (you can loop over it)</li>
          <li>Lazy (does not build a list in memory)</li>
          <li>Supports <code>len()</code>, indexing, slicing, and <code>in</code></li>
        </ul>
      </div>

      <div class="codeblock">
        <div class="bar">
          <span class="label">Quick demo: range is NOT a list</span>
          <button class="copy-btn" type="button">Copy</button>
        </div>
        <pre><code>r = range(5)
print(r)                 # range(0, 5)
print(type(r))           # &lt;class 'range'&gt;
print(list(r))           # [0, 1, 2, 3, 4]</code></pre>
      </div>

      <h2>2) Syntax (three forms)</h2>
      <div class="grid two">
        <div class="card">
          <h3><span class="chip">A</span> <code>range(stop)</code></h3>
          <div class="codeblock">
            <div class="bar">
              <span class="label">range(stop)</span>
              <button class="copy-btn" type="button">Copy</button>
            </div>
            <pre><code>print(list(range(5)))    # 0..4</code></pre>
          </div>

          <h3><span class="chip">B</span> <code>range(start, stop)</code></h3>
          <div class="codeblock">
            <div class="bar">
              <span class="label">range(start, stop)</span>
              <button class="copy-btn" type="button">Copy</button>
            </div>
            <pre><code>print(list(range(2, 7))) # 2..6</code></pre>
          </div>

          <h3>
            <span class="chip">C</span> <code>range(start, stop, step)</code>
          </h3>
          <div class="codeblock">
            <div class="bar">
              <span class="label">range(start, stop, step)</span>
              <button class="copy-btn" type="button">Copy</button>
            </div>
            <pre><code>print(list(range(1, 10, 2)))  # odds: 1,3,5,7,9</code></pre>
          </div>
        </div>

        <div class="callout">
          <h3>Golden rules</h3>
          <ul>
            <li><strong>Stop is excluded</strong> (range(5) ends at 4)</li>
            <li><strong>Step cannot be 0</strong></li>
            <li>Positive step counts up; negative step counts down</li>
            <li>Wrong step direction ‚áí empty range</li>
          </ul>
          <div class="codeblock" style="box-shadow: none; margin-top: 10px">
            <div class="bar">
              <span class="label">Empty range examples</span>
              <button class="copy-btn" type="button">Copy</button>
            </div>
            <pre><code>print(list(range(5, 1)))      # []
print(list(range(1, 5, -1)))  # []</code></pre>
          </div>
        </div>
      </div>

      <h2>3) Stop-excluded in real examples</h2>
      <div class="codeblock">
        <div class="bar">
          <span class="label">Counting and indexing</span>
          <button class="copy-btn" type="button">Copy</button>
        </div>
        <pre><code>items = ["a", "b", "c", "d"]

for i in range(len(items)):
    print(i, items[i])

print("Last:", items[len(items) - 1])</code></pre>
      </div>

      <h2>4) Negative steps</h2>
      <div class="codeblock">
        <div class="bar">
          <span class="label">Countdown patterns</span>
          <button class="copy-btn" type="button">Copy</button>
        </div>
        <pre><code>print(list(range(10, 0, -1)))   # 10..1
print(list(range(10, -1, -1)))  # 10..0</code></pre>
      </div>

      <h2>5) len(range(...))</h2>
      <div class="codeblock">
        <div class="bar">
          <span class="label">Fast size checks</span>
          <button class="copy-btn" type="button">Copy</button>
        </div>
        <pre><code>print(len(range(10)))
print(len(range(2, 10)))
print(len(range(1, 10, 2)))
print(len(range(10, 0, -1)))</code></pre>
      </div>

      <h2>6) range as a sequence</h2>
      <div class="grid two">
        <div class="codeblock">
          <div class="bar">
            <span class="label">Indexing + slicing + membership</span>
            <button class="copy-btn" type="button">Copy</button>
          </div>
          <pre><code>r = range(3, 20, 3)

print(r[0])
print(r[-1])
print(list(r[1:4]))

print(12 in r)
print(14 in r)</code></pre>
        </div>

        <div class="callout warn">
          <h3>Beginner mistakes</h3>
          <ul>
            <li>Expecting stop to be included</li>
            <li>Using wrong stop when reversing (include 0 ‚áí stop=-1)</li>
            <li>Step direction mismatch (empty range)</li>
            <li>Step = 0 (error)</li>
          </ul>
        </div>
      </div>

      <h2>7) Practical recipes</h2>
      <details open>
        <summary>‚úÖ 1 to n (inclusive)</summary>
        <div class="codeblock">
          <div class="bar">
            <span class="label">1..n</span>
            <button class="copy-btn" type="button">Copy</button>
          </div>
          <pre><code>n = 10
for i in range(1, n + 1):
    print(i)</code></pre>
        </div>
      </details>

      <details>
        <summary>‚úÖ Even numbers up to n</summary>
        <div class="codeblock">
          <div class="bar">
            <span class="label">Evens</span>
            <button class="copy-btn" type="button">Copy</button>
          </div>
          <pre><code>n = 20
for i in range(2, n + 1, 2):
    print(i)</code></pre>
        </div>
      </details>

      <details>
        <summary>‚úÖ Multiplication table 1..5</summary>
        <div class="codeblock">
          <div class="bar">
            <span class="label">Nested loops</span>
            <button class="copy-btn" type="button">Copy</button>
          </div>
          <pre><code>for i in range(1, 6):
    for j in range(1, 6):
        print(i * j, end="\t")
    print()</code></pre>
        </div>
      </details>

      <h2>8) Pyodide Python Editor (FIXED OUTPUT)</h2>
      <div class="card">
        <p class="muted" style="margin-top: 0">
          Output capture uses <code>write</code> (not batching) and decodes bytes
          correctly, so <code>print()</code> and <code>\n</code> always create
          proper line breaks.
        </p>

        <div class="editor">
          <div>
            <div
              class="row"
              style="justify-content: space-between; margin-bottom: 8px"
            >
              <span class="chip">Python code</span>
              <div class="row">
                <button id="runBtn" type="button" disabled>Run ‚ñ∂</button>
                <button id="resetBtn" type="button" class="btn-ghost">
                  Reset
                </button>
              </div>
            </div>

            <textarea id="codeArea" spellcheck="false"></textarea>

            <div class="row" style="margin-top: 10px">
              <span class="status" id="pyStatus">Loading Pyodide‚Ä¶</span>
              <button id="clearOutBtn" type="button" class="btn-ghost">
                Clear Output
              </button>
              <button id="copyOutBtn" type="button" class="btn-ghost">
                Copy Output
              </button>
            </div>

            <p class="muted" style="margin-top: 8px">
              Shortcut: <span class="kbd">Ctrl</span> + <span class="kbd">Enter</span>
            </p>
          </div>

          <div>
            <div
              class="row"
              style="justify-content: space-between; margin-bottom: 8px"
            >
              <span class="chip">Output</span>
              <span class="muted">stdout / errors</span>
            </div>
            <div id="output" class="output"></div>

            <div class="callout warn" style="margin-top: 10px">
              <h3 style="margin-top: 0">About <code>input()</code></h3>
              <p class="muted" style="margin-bottom: 0">
                <code>input()</code> is redirected to a browser prompt popup.
              </p>
            </div>
          </div>
        </div>
      </div>

      <h2>9) Mini practice tasks</h2>
      <ol>
        <li>Print 100 to 1 using <code>range</code>.</li>
        <li>Print multiples of 7 from 7 to 70.</li>
        <li>Print squares from 1 to 10.</li>
        <li>Take n and print all odd numbers up to n.</li>
        <li>Print index + character of a string using <code>range(len(s))</code>.</li>
      </ol>

      <footer>
        Built for learning ‚Ä¢ Comprehensive range() ‚Ä¢ Runs Python in-browser
        (Pyodide) ‚Ä¢ Light saffron theme
      </footer>
    </div>

    <script>
      // ---------- Copy helper ----------
      async function copyText(text) {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
          return;
        }
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        ta.style.top = "-9999px";
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
      }

      // Copy buttons (lesson blocks)
      document.querySelectorAll(".codeblock .copy-btn").forEach((btn) => {
        btn.addEventListener("click", async () => {
          const code =
            btn.closest(".codeblock")?.querySelector("pre code")?.innerText ||
            "";
          const old = btn.textContent;
          btn.disabled = true;
          btn.textContent = "Copying...";
          try {
            await copyText(code);
            btn.textContent = "Copied!";
          } catch (e) {
            btn.textContent = "Copy failed";
          }
          setTimeout(() => {
            btn.textContent = old;
            btn.disabled = false;
          }, 1200);
        });
      });

      // ---------- Pyodide Editor (correct output handling) ----------
      const outputEl = document.getElementById("output");
      const statusEl = document.getElementById("pyStatus");
      const runBtn = document.getElementById("runBtn");
      const resetBtn = document.getElementById("resetBtn");
      const clearOutBtn = document.getElementById("clearOutBtn");
      const copyOutBtn = document.getElementById("copyOutBtn");
      const codeArea = document.getElementById("codeArea");

      const DEFAULT_CODE = `# print() and \\n test (should look like terminal output)
print("Hello")
print("World")

print("A\\nB\\nC")

for i in range(1, 6):
    print(i)

print("range(5) ->", list(range(5)))
`;

      codeArea.value = DEFAULT_CODE;

      function setStatus(text) {
        statusEl.textContent = text;
      }

      // IMPORTANT:
      // 1) No batching: use { write: ... } (stream output)
      // 2) Decode Uint8Array correctly (fixes "53,10" output)
      const decoder = new TextDecoder("utf-8");

      function writeOut(chunk) {
        // chunk can be string OR Uint8Array (bytes)
        if (chunk instanceof Uint8Array) chunk = decoder.decode(chunk);
        outputEl.textContent += chunk;
        outputEl.scrollTop = outputEl.scrollHeight;
      }

      // input() shim
      async function installInputShim(pyodide) {
        pyodide.globals.set("js_input", (promptText) => {
          const v = window.prompt(promptText || "Input:");
          return v === null ? "" : v;
        });

        const shim = `
import builtins
def _browser_input(prompt=""):
    return js_input(str(prompt))
builtins.input = _browser_input
`;
        await pyodide.runPythonAsync(shim);
      }

      // Fail-safe promise (no hanging)
      let pyResolve, pyReject;
      const pyodideReady = new Promise((resolve, reject) => {
        pyResolve = resolve;
        pyReject = reject;
      });

      runBtn.disabled = true;

      (function loadPyodideSafe() {
        setStatus("Loading Pyodide‚Ä¶ (first load can take a bit)");
        writeOut("Loading Pyodide...\n");

        const script = document.createElement("script");
        script.src =
          "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js";

        script.onload = async () => {
          try {
            const pyodide = await loadPyodide({
              indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/",
            });

            // NO BATCHING: stream output exactly like terminal
            pyodide.setStdout({ write: writeOut });
            pyodide.setStderr({ write: writeOut });

            await installInputShim(pyodide);

            setStatus("Ready ‚úÖ");
            writeOut("Pyodide loaded ‚úÖ\n\n");
            runBtn.disabled = false;

            pyResolve(pyodide);
          } catch (err) {
            setStatus("Pyodide failed to load ‚ùå");
            writeOut("Error loading Pyodide:\n" + String(err) + "\n");
            pyReject(err);
          }
        };

        script.onerror = () => {
          const err = new Error("Network error: could not load pyodide.js");
          setStatus("Failed to load pyodide.js ‚ùå");
          writeOut(err.message + "\n");
          pyReject(err);
        };

        document.head.appendChild(script);
      })();

      async function runCode() {
        runBtn.disabled = true;
        setStatus("Running‚Ä¶");
        writeOut("‚ñ∂ Running...\n");

        try {
          const pyodide = await pyodideReady;
          await pyodide.runPythonAsync(codeArea.value);

          // Add a clean ending line (nice UX) if program didn't end with newline
          if (!outputEl.textContent.endsWith("\n")) writeOut("\n");

          writeOut("‚úì Done.\n");
          setStatus("Ready ‚úÖ");
        } catch (err) {
          writeOut("\n‚úó Error:\n" + String(err) + "\n");
          setStatus("Error ‚ùå");
        } finally {
          // keep disabled if pyodide failed
          try {
            await pyodideReady;
            runBtn.disabled = false;
          } catch {
            runBtn.disabled = true;
          }
        }
      }

      runBtn.addEventListener("click", runCode);

      // Ctrl+Enter to run
      codeArea.addEventListener("keydown", (e) => {
        if (e.ctrlKey && e.key === "Enter") {
          e.preventDefault();
          if (!runBtn.disabled) runCode();
        }
      });

      resetBtn.addEventListener("click", async () => {
        codeArea.value = DEFAULT_CODE;
        outputEl.textContent = "";
        try {
          await pyodideReady;
          setStatus("Ready ‚úÖ");
        } catch {
          setStatus("Loading Pyodide‚Ä¶");
        }
      });

      clearOutBtn.addEventListener("click", async () => {
        outputEl.textContent = "";
        try {
          await pyodideReady;
          setStatus("Ready ‚úÖ");
        } catch {
          setStatus("Loading Pyodide‚Ä¶");
        }
      });

      copyOutBtn.addEventListener("click", async () => {
        const old = copyOutBtn.textContent;
        copyOutBtn.disabled = true;
        copyOutBtn.textContent = "Copying...";
        try {
          await copyText(outputEl.textContent || "");
          copyOutBtn.textContent = "Copied!";
        } catch (e) {
          copyOutBtn.textContent = "Copy failed";
        }
        setTimeout(() => {
          copyOutBtn.textContent = old;
          copyOutBtn.disabled = false;
        }, 1200);
      });
    </script>
  </body>
</html>