<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Whiteboard PRO — Annotate • Draw • Shapes • Export</title>
  <meta name="description" content="Whiteboard PRO: draw, add shapes/text/images, snap-to-grid, undo/redo, export JSON. Part of ImageLab Studio."/>
  <link rel="stylesheet" href="whiteboard.css">
  <style>
    /* Small safety defaults if CSS is missing any */
    body{margin:0}
    .studio-back{position:fixed;left:12px;bottom:12px;z-index:99999}
    .studio-back a{display:inline-flex;gap:.5rem;align-items:center;padding:.55rem .8rem;border-radius:999px;
      background:#fff;border:1px solid #eadcc5;color:#1f2937;text-decoration:none;box-shadow:0 10px 24px rgba(31,41,55,.12)}
  </style>
</head>
<body>

  <!-- Top toolbar (IDs must match whiteboardcore.js + whiteboard.js expectations) -->
  <div id="toolbar" class="toolbar">
    <div class="toolbar__row">
      <button id="menuCollapse" class="btn btn--ghost" title="Collapse/Expand toolbar">☰</button>
      <div id="toolbarDropdown" class="toolbar__dropdown" aria-hidden="true"></div>

      <div class="group">
        <button id="selectTool" class="btn">Select</button>
        <button id="penTool" class="btn">Pen</button>
        <button id="eraserTool" class="btn">Eraser</button>
      </div>

      <div class="group hide-when-collapsed">
        <label class="lbl">Pen</label>
        <input id="penColor" type="color" value="#111827" title="Pen color"/>
        <input id="penSize" type="range" min="1" max="32" value="4" title="Pen size"/>
        <input id="penOpacity" type="range" min="0.05" max="1" step="0.05" value="1" title="Pen opacity"/>
      </div>

      <div class="group hide-when-collapsed">
        <label class="lbl">Eraser</label>
        <input id="eraserTool" type="hidden" />
        <input id="eraserSizeLabel" type="text" value="18" readonly style="width:44px;text-align:center"/>
        <input id="eraserSize" type="range" min="4" max="96" value="18" title="Eraser size"/>
      </div>

      <div class="group">
        <button id="addRect" class="btn">Rect</button>
        <button id="addCircle" class="btn">Circle</button>
        <button id="addText" class="btn">Text</button>
        <button id="addImage" class="btn">Image</button>
      </div>

      <div class="group hide-when-collapsed">
        <label class="lbl">Fill</label><input id="shapeFill" type="color" value="#fff7e6" />
        <label class="lbl">Border</label><input id="shapeBorder" type="color" value="#d97706" />
      </div>

      <div class="group hide-when-collapsed">
        <label class="lbl">Font</label>
        <input id="fontSize" type="number" min="10" max="96" value="22" style="width:64px"/>
        <input id="fontColor" type="color" value="#111827" />
      </div>

      <div class="group">
        <button id="undoBtn" class="btn">Undo</button>
        <button id="redoBtn" class="btn">Redo</button>
        <button id="dupBtn" class="btn hide-when-collapsed">Duplicate</button>
        <button id="clearAll" class="btn btn--danger">Clear</button>
      </div>

      <div class="group hide-when-collapsed">
        <label class="lbl"><input id="toggleGrid" type="checkbox" checked/> Grid</label>
        <label class="lbl"><input id="snapToggle" type="checkbox" checked/> Snap</label>
        <label class="lbl">Grid</label>
        <input id="gridSize" type="number" min="8" max="128" value="24" style="width:64px"/>
      </div>

      <div class="group">
        <button id="exportJSON" class="btn">Export JSON</button>
        <input id="importJSON" type="file" accept="application/json" class="hide-when-collapsed"/>
      </div>

      <div class="group">
        <button id="helpBtn" class="btn btn--ghost hide-when-collapsed">Help</button>
      </div>
    </div>
  </div>

  <!-- Workspace -->
  <div id="viewport" class="viewport">
    <div id="world" class="world">
      <canvas id="drawing" class="drawing"></canvas>
      <div id="objectsLayer" class="objectsLayer"></div>
      <div id="selRect" class="selRect" hidden></div>
      <div id="eraserCursor" class="eraserCursor" hidden></div>
    </div>
  </div>

  <!-- Help/Guide modal -->
  <div id="collapseGuide" class="modal" hidden>
    <div class="modal__card">
      <h2>Whiteboard PRO — Shortcuts & Tips</h2>
      <ul>
        <li><b>Select</b>: click objects, drag to move, use handles to resize/rotate.</li>
        <li><b>Pen</b>: draw freehand; adjust color/size/opacity.</li>
        <li><b>Eraser</b>: erase drawn strokes (size slider).</li>
        <li><b>Grid/Snap</b>: enable for neat alignment.</li>
        <li><b>Export JSON</b>: saves editable state; use Import to restore.</li>
      </ul>
      <button id="closeGuide" class="btn">Close</button>
    </div>
  </div>

  <div class="studio-back">
    <a href="../index.html">← Back to ImageLab Studio</a>
  </div>

  <script src="whiteboardcore.js"></script>
  <script src="whiteboard.js"></script>
</body>
</html>
