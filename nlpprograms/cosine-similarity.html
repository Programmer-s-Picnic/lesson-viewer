<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cosine Similarity — Colored Vector Lab</title>

<style>
:root{
--bg:#fffaf2;--card:#ffffff;--ink:#1f2937;--muted:#6b7280;
--brand:#d97706;--border:#e5e7eb;--ok:#059669;
--warn:#b45309;--bad:#dc2626;--radius:16px;
--shadow:0 10px 30px rgba(0,0,0,.06);
font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
body{margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--ink)}
header{text-align:center;padding:24px}
.wrap{max-width:1100px;margin:auto;padding:16px}
.grid{display:grid;gap:16px}
@media(min-width:980px){.grid{grid-template-columns:1.1fr .9fr}}
.card{background:var(--card);border:1px solid var(--border);
border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
textarea,select{width:100%;border:1px solid var(--border);
border-radius:12px;padding:10px;font:inherit}
button{border:none;border-radius:12px;padding:10px 14px;
font-weight:700;cursor:pointer;background:var(--brand);color:#fff}
button.ghost{background:#f3f4f6;color:#111;border:1px solid var(--border)}
pre{background:#0b1020;color:#e5e7eb;border-radius:12px;padding:12px}
.row{display:flex;gap:10px;flex-wrap:wrap}
.status{margin-top:10px;padding:10px;border-radius:12px;font-weight:700}
.status.ok{background:#ecfdf5;color:#065f46}
.status.warn{background:#fff7ed;color:#9a3412}
.status.bad{background:#fef2f2;color:#991b1b}
.legend{display:flex;gap:14px;flex-wrap:wrap;margin-top:8px;font-size:14px}
.legend span{display:flex;align-items:center;gap:6px}
.legend i{width:14px;height:14px;border-radius:3px;display:inline-block}
.explain{margin-top:10px;font-size:14px;color:var(--muted);line-height:1.7}
footer{text-align:center;font-size:13px;color:var(--muted);margin:20px}
</style>
</head>

<body>

<header>
<h1>Cosine Similarity — Colored Vector Visualization</h1>
<p>See how sentence meaning becomes vectors, angles, and cosine similarity.</p>
</header>

<div class="wrap">
<div class="grid">

<section class="card">
<h2>Concept Reminder</h2>
<ul>
<li>Each sentence → a vector of word counts</li>
<li>Vectors point in directions</li>
<li>Smaller angle = more similar meaning</li>
<li>Cosine similarity = cos(θ)</li>
</ul>
</section>

<aside class="card">
<h2>Live Python Lab</h2>

<label><b>Sentence 1</b></label>
<textarea id="s1">show me quizzes</textarea>

<label><b>Sentence 2</b></label>
<textarea id="s2">open quizzes</textarea>

<label><b>Stopwords</b></label>
<select id="stop">
<option value="yes">Remove stopwords</option>
<option value="no">Keep stopwords</option>
</select>

<h3>Editable Python Code</h3>
<textarea id="pyCode" style="min-height:300px;font-family:monospace"></textarea>

<div class="row">
<button id="run">Run Python</button>
<button id="reset" class="ghost">Reset</button>
</div>

<div id="status" class="status warn">⏳ Loading Pyodide…</div>

<h3>Output</h3>
<pre id="out">Waiting…</pre>

<h3>Vector Angle Graph</h3>
<div style="border:1px solid var(--border);border-radius:12px;padding:12px">

<svg id="vecSvg" viewBox="0 0 520 320" width="100%" height="320">
<defs>
<pattern id="grid" width="26" height="26" patternUnits="userSpaceOnUse">
<path d="M 26 0 L 0 0 0 26" fill="none" stroke="rgba(0,0,0,.08)" stroke-width="1"/>
</pattern>
<marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
<path d="M0,0 L10,3 L0,6 Z" fill="currentColor"/>
</marker>
</defs>

<rect x="0" y="0" width="520" height="320" fill="url(#grid)"/>

<!-- Axes -->
<line x1="60" y1="260" x2="500" y2="260" stroke="#bbb" stroke-width="2"/>
<line x1="260" y1="20" x2="260" y2="300" stroke="#bbb" stroke-width="2"/>

<!-- Origin -->
<circle cx="260" cy="260" r="4" fill="#555"/>

<!-- Vector A (Blue) -->
<line id="vecA" x1="260" y1="260" x2="260" y2="260"
stroke="#2563eb" stroke-width="4" marker-end="url(#arrow)"/>

<!-- Vector B (Saffron) -->
<line id="vecB" x1="260" y1="260" x2="260" y2="260"
stroke="#d97706" stroke-width="4" marker-end="url(#arrow)" opacity="0.85"/>

<!-- Angle Arc (Green) -->
<path id="angleArc" d="" fill="none" stroke="#059669" stroke-width="4"/>

<text id="angleText" x="16" y="24" fill="#065f46">θ = --°</text>
<text id="cosText" x="16" y="44" fill="#065f46">cos = --</text>
</svg>

<div class="legend">
<span><i style="background:#2563eb"></i> Vector A (Sentence 1)</span>
<span><i style="background:#d97706"></i> Vector B (Sentence 2)</span>
<span><i style="background:#059669"></i> Angle θ</span>
</div>

<div class="explain">
<b>How to read this graph:</b><br/>
• The <b>blue arrow</b> represents Sentence&nbsp;1 as a vector.<br/>
• The <b>saffron arrow</b> represents Sentence&nbsp;2 as a vector.<br/>
• The <b>green arc</b> shows the angle (θ) between them.<br/><br/>
If the arrows point in nearly the <b>same direction</b>, the angle is small and cosine similarity is high (meanings are similar).  
If the arrows point in <b>very different directions</b>, the angle is large and cosine similarity is low.
</div>

</div>
</aside>

</div>

<footer>
By <b>Champak Roy</b> • Programmer’s Picnic
</footer>
</div>

<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>

<script>
const codeEl = document.getElementById("pyCode");
const outEl = document.getElementById("out");
const statusEl = document.getElementById("status");

const DEFAULT_CODE = `
import re, math, sys, io, json
STOPWORDS={"the","is","a","me","to","of","and","on","in","for","show","open"}
buf=io.StringIO(); sys.stdout=buf

def tok(t,r=True):
 t=t.lower(); t=re.sub(r"[^a-z0-9\\s]"," ",t)
 w=t.split()
 return [x for x in w if (x not in STOPWORDS) or not r]

def cos(A,B):
 d=sum(a*b for a,b in zip(A,B))
 ma=math.sqrt(sum(x*x for x in A))
 mb=math.sqrt(sum(x*x for x in B))
 return (0,d,ma,mb) if ma*mb==0 else (d/(ma*mb),d,ma,mb)

r=REMOVE_STOPWORDS=="yes"
t1,t2=tok(S1,r),tok(S2,r)
v=sorted(set(t1)|set(t2))
A=[t1.count(x) for x in v]
B=[t2.count(x) for x in v]
c,d,ma,mb=cos(A,B)
th=math.degrees(math.acos(max(-1,min(1,c)))) if ma*mb else 0

print("A =",A)
print("B =",B)
print("Cosine =",round(c,4))
print("__DATA__"+json.dumps({"A":A,"B":B,"cos":c,"theta":th}))
buf.getvalue()
`.trim();

codeEl.value = DEFAULT_CODE;

let pyodide;
(async()=>{
pyodide = await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.23.4/full/"});
statusEl.className="status ok";
statusEl.textContent="✅ Pyodide Ready";
})();

function draw(A,B,cos){
const o={x:260,y:260}, s=95;
const ax=A[0]||0, ay=A[1]||0, bx=B[0]||0, by=B[1]||0;
const na=Math.hypot(ax,ay)||1, nb=Math.hypot(bx,by)||1;
vecA.setAttribute("x2",o.x+(ax/na)*s);
vecA.setAttribute("y2",o.y-(ay/na)*s);
vecB.setAttribute("x2",o.x+(bx/nb)*s);
vecB.setAttribute("y2",o.y-(by/nb)*s);
const th=Math.acos(Math.max(-1,Math.min(1,cos)));
angleText.textContent=`θ = ${(th*180/Math.PI).toFixed(1)}°`;
cosText.textContent=`cos = ${cos.toFixed(4)}`;
}

run.onclick=async()=>{
pyodide.globals.set("S1",s1.value);
pyodide.globals.set("S2",s2.value);
pyodide.globals.set("REMOVE_STOPWORDS",stop.value);
const r=await pyodide.runPythonAsync(codeEl.value);
outEl.textContent=r;
const i=r.lastIndexOf("__DATA__");
if(i!=-1){
const d=JSON.parse(r.slice(i+8));
draw(d.A,d.B,d.cos);
}
};

reset.onclick=()=>codeEl.value=DEFAULT_CODE;
</script>

</body>
</html>